x = [9.895833134651184082e-01,1.000000000000000000e+00,9.699074029922485352e-01,9.201388955116271973e-01,9.189814925193786621e-01,8.993055820465087891e-01,8.113425970077514648e-01,6.516203880310058594e-01,3.958333432674407959e-01,3.043981492519378662e-01,3.159722089767456055e-01,2.905092537403106689e-01,2.662037014961242676e-01,2.557870447635650635e-01,2.488425970077514648e-01,2.337962985038757324e-01,2.326388955116271973e-01,2.326388955116271973e-01,2.280092537403106689e-01,2.314814776182174683e-01,2.291666716337203979e-01,2.372685223817825317e-01,2.453703731298446655e-01,2.268518507480621338e-01,2.118055522441864014e-01,1.956018507480621338e-01,1.504629701375961304e-01,9.953703731298446655e-02,6.365741044282913208e-02,5.439814925193786621e-02,3.472222387790679932e-02,1.273148134350776672e-02,0.000000000000000000e+00,4.629629664123058319e-03,2.314814832061529160e-03,1.157407416030764580e-03,1.851851865649223328e-02,4.861111193895339966e-02,8.217592537403106689e-02,1.122685149312019348e-01,1.458333283662796021e-01,1.898148208856582642e-01,2.233796268701553345e-01,2.407407462596893311e-01,2.581018507480621338e-01,2.685185074806213379e-01,2.766203582286834717e-01,2.731481492519378662e-01,2.766203582286834717e-01,2.789351940155029297e-01,2.812500000000000000e-01,2.743055522441864014e-01,2.777777910232543945e-01,2.789351940155029297e-01,2.870370447635650635e-01,2.847222089767456055e-01,2.847222089767456055e-01,2.951388955116271973e-01,2.905092537403106689e-01,2.870370447635650635e-01,2.951388955116271973e-01,3.020833432674407959e-01,2.986111044883728027e-01,2.951388955116271973e-01,2.962962985038757324e-01,3.020833432674407959e-01,3.009259402751922607e-01,2.997685074806213379e-01,3.055555522441864014e-01,3.113425970077514648e-01,3.078703582286834717e-01,3.020833432674407959e-01,3.055555522441864014e-01,3.090277910232543945e-01,3.113425970077514648e-01,3.032407462596893311e-01,3.032407462596893311e-01,3.125000000000000000e-01,3.113425970077514648e-01,3.101851940155029297e-01,3.090277910232543945e-01,3.171296417713165283e-01,3.206018507480621338e-01,3.113425970077514648e-01,3.125000000000000000e-01,3.182870447635650635e-01,3.159722089767456055e-01,3.136574029922485352e-01,3.125000000000000000e-01,3.194444477558135986e-01,3.182870447635650635e-01,3.171296417713165283e-01,3.101851940155029297e-01,3.194444477558135986e-01,3.206018507480621338e-01,3.159722089767456055e-01,3.206018507480621338e-01,3.182870447635650635e-01,3.206018507480621338e-01,3.148148059844970703e-01,3.113425970077514648e-01,3.206018507480621338e-01,3.240740597248077393e-01,3.171296417713165283e-01,3.148148059844970703e-01,3.252314925193786621e-01,3.229166567325592041e-01,3.159722089767456055e-01,3.194444477558135986e-01,3.252314925193786621e-01,3.206018507480621338e-01,3.182870447635650635e-01,3.240740597248077393e-01,3.217592537403106689e-01,3.263888955116271973e-01,3.229166567325592041e-01,3.206018507480621338e-01,3.229166567325592041e-01,3.252314925193786621e-01,3.240740597248077393e-01,3.229166567325592041e-01,3.287037014961242676e-01,3.252314925193786621e-01,3.263888955116271973e-01,3.217592537403106689e-01,3.310185074806213379e-01,3.263888955116271973e-01,3.240740597248077393e-01,3.240740597248077393e-01,3.310185074806213379e-01,3.379629552364349365e-01,3.495370447635650635e-01,3.564814925193786621e-01,3.715277910232543945e-01,3.958333432674407959e-01,4.097222089767456055e-01,3.993055522441864014e-01,4.074074029922485352e-01,3.912037014961242676e-01,3.483796417713165283e-01,3.206018507480621338e-01,3.240740597248077393e-01,3.263888955116271973e-01,3.148148059844970703e-01,3.182870447635650635e-01,3.252314925193786621e-01,3.159722089767456055e-01,3.078703582286834717e-01,4.085648059844970703e-01,6.504629850387573242e-01,8.263888955116271973e-01,7.835648059844970703e-01,4.849537014961242676e-01,2.777777910232543945e-01,3.599537014961242676e-01,3.622685074806213379e-01,3.171296417713165283e-01,3.206018507480621338e-01,3.240740597248077393e-01,3.148148059844970703e-01,3.148148059844970703e-01,3.182870447635650635e-01,3.125000000000000000e-01,3.078703582286834717e-01,3.032407462596893311e-01,3.101851940155029297e-01,3.113425970077514648e-01,3.055555522441864014e-01,3.055555522441864014e-01,3.148148059844970703e-01,3.043981492519378662e-01,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00]




import pandas as pd
import torch
import torch.nn as nn
import torch.optim as optim
from torch.utils.data import Dataset, DataLoader
import numpy as np
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")



# === Исправленная модель ===
class ECGModel(nn.Module):
    def __init__(self, input_size, hidden_size, num_classes):
        super().__init__()
        self.layer1 = nn.Sequential(
            nn.Linear(input_size, hidden_size),
            nn.ReLU(),
            nn.Dropout(0.3)
        )
        self.layer2 = nn.Sequential(
            nn.Linear(hidden_size, hidden_size // 2),
            nn.ReLU(),
            nn.Dropout(0.3)
        )
        self.fc = nn.Linear(hidden_size // 2, num_classes)

    def forward(self, x):
        # Добавляем размерность батча если ее нет
        if len(x.shape) == 1:
            x = x.unsqueeze(0)

        out = self.layer1(x)
        out = self.layer2(out)
        out = self.fc(out)
        return out




x = torch.tensor(x)


input_size = len(x)
hidden_size = 128

model = ECGModel(input_size, hidden_size, 5).to(device)
model.load_state_dict(torch.load('best_model.pth', map_location=device))
model.eval()

# ----- Подготовка изображения -----




# ----- Предсказание -----

with torch.no_grad():
    outputs = model(x)
    print(outputs)
    #prediction = (output >= 0.5).float().item()
    #probability = output.item()

#label = "открыты" if prediction == 1.0 else "закрыты"
#print(f"Prediction: {label} (Probability: {probability:.4f})")

